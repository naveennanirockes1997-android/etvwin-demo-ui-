import{a as M,r,j as e,X as A,S as N}from"./index-DEpxVuBu.js";import{a as B}from"./api-CnTjIxnj.js";import{S,C}from"./SkeletonCard-em0vftH_.js";import{F as E}from"./funnel-SDIYlv5g.js";import{S as L,C as I}from"./star-BUhvRgiH.js";const T=()=>{const[k]=M(),l=k.get("q")||"",[i,o]=r.useState([]),[d,f]=r.useState(!1),[x,b]=r.useState(!1),[m,p]=r.useState(1),[j,g]=r.useState(!0),[h,v]=r.useState(!1),[n,y]=r.useState({rating:"",year:"",sortBy:"relevance"}),c=r.useRef(),F=r.useCallback(t=>{d||x||(c.current&&c.current.disconnect(),c.current=new IntersectionObserver(s=>{s[0].isIntersecting&&j&&p(a=>a+1)}),t&&c.current.observe(t))},[d,x,j]),w=async(t,s=!1)=>{if(!l){o([]);return}s?f(!0):b(!0);try{const a=await B.searchContent(l,n,t,12);o(s?a.items||[]:z=>[...z,...a.items||[]]),g(a.hasMore)}catch(a){console.error("Search failed:",a)}finally{f(!1),b(!1)}};r.useEffect(()=>{p(1),g(!0),w(1,!0)},[l,n]),r.useEffect(()=>{m>1&&w(m)},[m]);const u=(t,s)=>{y(a=>({...a,[t]:s}))},R=()=>{y({rating:"",year:"",sortBy:"relevance"})};return e.jsxs("div",{className:"pt-24 px-4 md:px-12 pb-20 min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl text-text-muted",children:l?e.jsxs(e.Fragment,{children:["Results for ",e.jsxs("span",{className:"text-white font-bold italic",children:['"',l,'"']})]}):"Type to start searching..."}),i.length>0&&e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:[i.length," items found"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>v(!h),className:`flex items-center gap-2 px-6 py-2.5 rounded-full border transition-all ${h||Object.values(n).some(t=>t&&t!=="relevance")?"bg-primary/10 border-primary text-primary":"bg-surface-light border-white/10 hover:bg-zinc-800"}`,children:[e.jsx(E,{size:18}),e.jsx("span",{className:"font-bold text-sm",children:"Filters"})]}),h&&e.jsxs("div",{className:"absolute right-0 top-full mt-4 w-72 bg-surface-dark border border-white/10 rounded-2xl p-6 z-50 shadow-2xl backdrop-blur-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-bold",children:"Refine Results"}),e.jsx("button",{onClick:()=>v(!1),className:"text-text-muted hover:text-white",children:e.jsx(A,{size:18})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx(L,{size:14})," Min Rating"]}),e.jsxs("select",{value:n.rating,onChange:t=>u("rating",t.target.value),className:"w-full bg-surface-light border border-white/10 rounded-lg px-4 py-2 outline-none focus:border-primary transition-colors text-sm",children:[e.jsx("option",{value:"",children:"Any Rating"}),e.jsx("option",{value:"90",children:"90% +"}),e.jsx("option",{value:"80",children:"80% +"}),e.jsx("option",{value:"70",children:"70% +"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx(I,{size:14})," Release Year"]}),e.jsxs("select",{value:n.year,onChange:t=>u("year",t.target.value),className:"w-full bg-surface-light border border-white/10 rounded-lg px-4 py-2 outline-none focus:border-primary transition-colors text-sm",children:[e.jsx("option",{value:"",children:"Any Year"}),e.jsx("option",{value:"2000",children:"2000 & Later"}),e.jsx("option",{value:"1990",children:"1990 & Later"}),e.jsx("option",{value:"1980",children:"1980 & Later"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:"Sort By"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["relevance","newest","rating"].map(t=>e.jsx("button",{onClick:()=>u("sortBy",t),className:`px-4 py-2 rounded-lg text-xs font-bold capitalize border transition-all ${n.sortBy===t?"bg-primary border-primary text-white":"bg-surface-light border-white/5 text-text-muted hover:border-white/20"}`,children:t},t))})]}),e.jsx("button",{onClick:R,className:"w-full py-2.5 bg-white/5 hover:bg-white/10 rounded-lg text-xs font-bold transition-colors border border-white/5",children:"Clear All Filters"})]})]})]})]}),d?e.jsx("div",{className:"content-grid",children:Array.from({length:12}).map((t,s)=>e.jsx(S,{},s))}):i.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"content-grid",children:i.map((t,s)=>i.length===s+1?e.jsx("div",{ref:F,children:e.jsx(C,{item:t})},t.id):e.jsx(C,{item:t},t.id))}),x&&e.jsx("div",{className:"content-grid mt-4",children:Array.from({length:4}).map((t,s)=>e.jsx(S,{},`more-${s}`))})]}):l?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mb-6",children:e.jsx(N,{size:40,className:"text-text-muted"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No results found"}),e.jsxs("p",{className:"text-text-muted max-w-md",children:['Your search for "',l,'" did not have any matches. Try different keywords or browse our categories.']})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center opacity-50",children:[e.jsx(N,{size:64,className:"text-text-muted mb-6"}),e.jsx("h2",{className:"text-xl font-medium",children:"Start typing to find your favorite films"})]})]})};export{T as default};
