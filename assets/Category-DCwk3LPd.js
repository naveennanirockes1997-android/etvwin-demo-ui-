import{u as S,r as s,j as e,X as F}from"./index-DEpxVuBu.js";import{a as R}from"./api-CnTjIxnj.js";import{C as w,S as N}from"./SkeletonCard-em0vftH_.js";import{F as z}from"./funnel-SDIYlv5g.js";import{S as $,C as B}from"./star-BUhvRgiH.js";const Y=()=>{const{categoryId:n}=S(),[c,d]=s.useState([]),[x,j]=s.useState(!0),[u,v]=s.useState(!1),[i,h]=s.useState(1),[m,f]=s.useState(!0),[b,y]=s.useState(!1),[a,g]=s.useState({rating:"",year:"",sortBy:""}),o=s.useRef(),C=s.useCallback(t=>{x||u||(o.current&&o.current.disconnect(),o.current=new IntersectionObserver(r=>{r[0].isIntersecting&&m&&h(l=>l+1)}),t&&o.current.observe(t))},[x,u,m]);s.useEffect(()=>{d([]),h(1),f(!0),g({rating:"",year:"",sortBy:""})},[n]),s.useEffect(()=>{h(1),f(!0)},[a]),s.useEffect(()=>{(async()=>{i===1?j(!0):v(!0);try{const r=await R.getContentByCategory(n,i,12,a);d(i===1?r||[]:l=>[...l,...r||[]]),f(r.length===12)}catch(r){console.error("Failed to fetch category items:",r)}finally{j(!1),v(!1)}})()},[i,a,n]);const p=(t,r)=>{g(l=>({...l,[t]:r}))},k=()=>{g({rating:"",year:"",sortBy:""})};return e.jsxs("div",{className:"pt-28 px-4 md:px-12 pb-20 min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between mb-10",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-black capitalize tracking-tight",children:n?.replace("-"," ")}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>y(!b),className:`flex items-center gap-2 px-6 py-3 rounded-full border transition-all ${b||Object.values(a).some(t=>t)?"bg-primary/10 border-primary text-primary":"bg-surface-light hover:bg-zinc-800 border-white/5"}`,children:[e.jsx(z,{size:20}),e.jsx("span",{className:"font-bold",children:"Filters"})]}),b&&e.jsxs("div",{className:"absolute right-0 top-full mt-4 w-72 bg-surface-dark border border-white/10 rounded-2xl p-6 z-50 shadow-2xl backdrop-blur-xl animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-bold",children:"Refine Results"}),e.jsx("button",{onClick:()=>y(!1),className:"text-text-muted hover:text-white",children:e.jsx(F,{size:18})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx($,{size:14})," Min Rating"]}),e.jsxs("select",{value:a.rating,onChange:t=>p("rating",t.target.value),className:"w-full bg-surface-light border border-white/10 rounded-lg px-4 py-2 outline-none focus:border-primary transition-colors text-sm",children:[e.jsx("option",{value:"",children:"Any Rating"}),e.jsx("option",{value:"90",children:"90% +"}),e.jsx("option",{value:"80",children:"80% +"}),e.jsx("option",{value:"70",children:"70% +"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3 flex items-center gap-2",children:[e.jsx(B,{size:14})," Release Year"]}),e.jsxs("select",{value:a.year,onChange:t=>p("year",t.target.value),className:"w-full bg-surface-light border border-white/10 rounded-lg px-4 py-2 outline-none focus:border-primary transition-colors text-sm",children:[e.jsx("option",{value:"",children:"Any Year"}),e.jsx("option",{value:"2000",children:"2000 & Later"}),e.jsx("option",{value:"1990",children:"1990 & Later"}),e.jsx("option",{value:"1980",children:"1980 & Later"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:"Sort By"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Default",value:""},{label:"Newest",value:"newest"},{label:"Review Score",value:"rating"}].map(t=>e.jsx("button",{onClick:()=>p("sortBy",t.value),className:`px-4 py-2 rounded-lg text-xs font-bold capitalize border transition-all ${a.sortBy===t.value?"bg-primary border-primary text-white":"bg-surface-light border-white/5 text-text-muted hover:border-white/20"}`,children:t.label},t.value))})]}),e.jsx("button",{onClick:k,className:"w-full py-2.5 bg-white/5 hover:bg-white/10 rounded-lg text-xs font-bold transition-colors border border-white/5",children:"Clear All Filters"})]})]})]})]}),e.jsxs("div",{className:"content-grid",children:[c.map((t,r)=>c.length===r+1?e.jsx("div",{ref:C,children:e.jsx(w,{item:t})},`${t.id}-${r}`):e.jsx(w,{item:t},`${t.id}-${r}`)),x&&Array.from({length:12}).map((t,r)=>e.jsx(N,{},`skel-${r}`))]}),u&&e.jsx("div",{className:"content-grid mt-4",children:Array.from({length:4}).map((t,r)=>e.jsx(N,{},`more-${r}`))}),!m&&c.length>0&&e.jsx("p",{className:"text-center text-text-muted mt-16 italic font-medium",children:"You've explored all content in this category."})]})};export{Y as default};
